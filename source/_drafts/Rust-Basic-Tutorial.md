---
title: Rust Basic Tutorial
date: 2021-09-18 14:25:28
categories: å­¦ä¹ ç¬”è®°
tags:
  - Rust
  - Programming
---

## åŸºç¡€æ¦‚å¿µ

### å˜é‡å’Œå¯å˜æ€§

#### å˜é‡

Rust ä¸­å˜é‡æœ‰å¯å˜å˜é‡ï¼ˆ_mutable variable_ï¼‰å’Œä¸å¯å˜å˜é‡ï¼ˆ_immutable variable_ï¼‰çš„åŒºåˆ†ï¼Œçœ‹å¦‚ä¸‹çš„ä»£ç ï¼š

```rust
fn main() {
    let x = 5;
    println!("{}", x);
    x = 6;
    println!("{}", x);
}
```

ä½¿ç”¨ `cargo run`è¿è¡Œï¼š

```shell
cargo run
   Compiling hello-rust v0.1.0 (H:\Coding\Rust\hello-rust)
error[E0384]: cannot assign twice to immutable variable `x`
 --> src\main.rs:4:5
  |
2 |     let x = 5;
  |         -
  |         |
  |         first assignment to `x`
  |         help: consider making this binding mutable: `mut x`
3 |     println!("{}", x); // 5
4 |     x = 6;
  |     ^^^^^ cannot assign twice to immutable variable

error: aborting due to previous error

For more information about this error, try `rustc --explain E0384`.
error: could not compile `hello-rust`

To learn more, run the command again with --verbose.
```

ä¸Šé¢çš„é”™è¯¯è¡¨æ˜ï¼Œå˜é‡`x`æ— æ³•äºŒæ¬¡èµ‹å€¼ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª _immutable variable_ã€‚å¦å¤–æŠ¥é”™è¿˜è¯´æ˜ï¼ŒRust åœ¨ç¼–è¯‘æœŸé—´å°±å·²ç»å¯¹ç¨‹åºå¯èƒ½å‡ºç°çš„æŸäº›é—®é¢˜ä½œäº†åˆ¤æ–­ï¼Œå¦‚æœä¸é€šè¿‡æ£€æŸ¥åˆ™ç¼–è¯‘å¤±è´¥ã€‚

```rust
fn main() {
    let mut x = 5;
    println!("{}", x);	// 5
    x = 6;
    println!("{}", x);	// 6
}
```

é€šè¿‡`let mut x = 5`çš„æ–¹å¼å°†`x`åˆå§‹åŒ–ä¸ºå¯å˜å˜é‡ã€‚

#### å¸¸é‡

å¸¸é‡çš„å£°æ˜ä½¿ç”¨å¦‚ä¸‹å½¢å¼çš„è¯­å¥ï¼š

```rust
// const [NAME]: [DATA_TYPE] = [DATA];
const PI: f32 = 3.14159;
```

#### å·®åˆ«

å¸¸é‡å’Œå˜é‡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ

1.  å¸¸é‡æ— æ³•ä½¿ç”¨`mut`ä¿®é¥°ï¼Œå®ƒå§‹ç»ˆæ˜¯ä¸å¯å˜çš„ï¼›
2.  å¸¸é‡ä½¿ç”¨`const`å£°æ˜ï¼Œå˜é‡ä½¿ç”¨`let`ï¼›
3.  å¸¸é‡å¿…é¡»å§‹ç»ˆæ³¨æ˜å…¶æ•°æ®ç±»å‹ï¼›
4.  å¸¸é‡å¯ä»¥å†ä»»ä½•èŒƒå›´å£°æ˜ï¼Œå¦‚å…¨å±€å¸¸é‡ã€å±€éƒ¨å¸¸é‡ï¼›
5.  å¸¸é‡æ˜¯é€šè¿‡å¸¸é‡è¡¨è¾¾å¼ç¡®å®šå€¼çš„ï¼Œåœ¨ç¼–è¯‘å™¨å…¶å€¼å°±ä¼šè¢«ç¡®å®šï¼Œè€Œå˜é‡çš„å€¼å¯ä»¥åœ¨è¿è¡Œæ—¶èµ‹äºˆã€‚

#### Shadowing

Rust æ”¯æŒä½¿ç”¨`let`å…³é”®å­—è¿›è¡ŒåŒåå˜é‡çš„é‡å¤åˆå§‹åŒ–ï¼š

```rust
fn main() {
    let x = 5;

    let x = x + 1;

    let x = x * 2;

    println!("The value of x is: {}", x);	// The value of x is: 12
}
```

ç”šè‡³å¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªä¸åŒç±»å‹çš„åŒåå˜é‡ï¼š

```rust
fn main() {
    let string = "abc";

    let string = string.len();

    println!("The length of string is: {}", string)	// The length of string is: 3
}
```

ç¬¬ä¸€ä¸ª`string`å’Œç¬¬äºŒä¸ª`string`å¹¶éåŒä¸€ä¸ªå˜é‡ï¼Œå®ƒä»¬åªæ˜¯åŒåï¼Œä¸åŒäº`mut`å˜é‡ï¼Œå…¶ä¸¤ä¸ªåŒåå˜é‡ä¹‹é—´æ˜¯æ²¡æœ‰å…³è”çš„ã€‚æŒ‰ Rust å®˜æ–¹çš„è¯´æ³•ï¼Œç¬¬ä¸€ä¸ªå˜é‡è¢«ç¬¬äºŒä¸ªå˜é‡é®è”½ï¼ˆ_shadowed_ï¼‰äº†ï¼Œå› æ­¤è¿™ä¸ªæ¦‚å¿µåœ¨ Rust ä¸­å«åš**_Shadowing_**ã€‚

å¦‚æœå¯¹`mut`å˜é‡èµ‹æ–°å€¼ï¼š

```rust
fn main() {
    let mut string = "abc";

	string = string.len();

    println!("The length of string is: {}", string)
}
```

ä¸Šé¢çš„ä»£ç åœ¨ç¼–è¯‘æ—¶å°±æ— æ³•é€šè¿‡ï¼Œå› ä¸ºå…¶ç±»å‹ä¸åŒ¹é…ã€‚

çœ‹ä¸‹é¢ä¸€æ®µä»£ç ï¼Œå¯¹`mut`å˜é‡è¿›è¡Œäº†é‡æ–°èµ‹å€¼ï¼š

```rust
fn main() {
    let mut string = "abc";

    string = "xyz";

    println!("The string is: {}", string)	// The string is: xyz
}
```

è¿™æ®µä»£ç èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯ç¼–è¯‘æœŸé—´ä¼šè¾“å‡º`warning`ï¼Œå³è­¦å‘Šä¿¡æ¯ã€‚è¿™æ˜¯å› ä¸º`"abc"`å­—ç¬¦ä¸²å¹¶æ²¡æœ‰ä½¿ç”¨å°±è¢«`"xyz"`è¦†ç›–äº†ï¼Œæ‰€ä»¥å‡ºç°è­¦å‘Šï¼Œä½†è¿™å¹¶ä¸å½±å“ç¨‹åºçš„æ‰§è¡Œã€‚

### æ•°æ®ç±»å‹

æ•°æ®ç±»å‹æ˜¯é™æ€ç±»å‹ç›¸å½“é‡è¦çš„éƒ¨åˆ†ï¼ŒRust ä½œä¸ºä¸€ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå…¶æ¯ä¸€ä¸ªå€¼éƒ½æœ‰æŒ‡å®šçš„ç±»å‹ï¼Œæ‰€æœ‰å˜é‡çš„ç±»å‹åœ¨ç¼–è¯‘æœŸé—´å°±å·²ç»ç¡®å®šäº†ã€‚

Rust ä¸­æ•°æ®ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ ‡é‡ç±»å‹ï¼ˆ_scalar_ï¼‰ä»¥åŠå¤åˆç±»å‹ï¼ˆ_compound_ï¼‰ã€‚

#### æ ‡é‡ç±»å‹

æ ‡é‡ç±»å‹æ˜¯ç®€å•ç±»å‹ï¼Œä»£è¡¨äº†å•ä¸ªå€¼ã€‚Rust ä¸­æœ‰å››ç§æ ‡é‡ç±»å‹ï¼š

- æ•´æ•°
- æµ®ç‚¹æ•°
- å¸ƒå°”å€¼
- å­—ç¬¦

##### æ•´æ•°

Rust ä¸­çš„æ•´æ•°ç±»å‹å¦‚ä¸‹è¡¨ï¼š

| é•¿åº¦ï¼ˆLengthï¼‰ | æœ‰ç¬¦å·ï¼ˆSignedï¼‰ | æ— ç¬¦å·ï¼ˆUnsignedï¼‰ |
| :------------: | :--------------: | :----------------: |
|     8-bit      |        i8        |         u8         |
|     16-bit     |       i16        |        u16         |
|     32-bit     |       i32        |        u32         |
|     64-bit     |       i64        |        u64         |
|    128-bit     |       i128       |        u128        |
|      arch      |      isize       |       usize        |

`arch` å³ architectureï¼Œè¡¨ç¤º CPU æ¶æ„çš„ä½æ•°ï¼Œå¦‚ 64-bit æœºå™¨ä¸Šå°±æ˜¯ 64 bitsï¼Œ32-bit æœºå™¨ä¸Šå°±æ˜¯ 32 bitsï¼Œè¿™åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€é‡Œä¹Ÿå¾ˆå¸¸è§ï¼Œå¦‚ C ä¸­çš„`int`ç±»å‹ã€‚

æ•´æ•°ç±»å‹çš„å­—é¢é‡è¡¨ç¤ºå¦‚ä¸‹è¡¨ï¼š

| å­—é¢é‡ï¼ˆNumber literalsï¼‰ |    ç¤ºä¾‹     |
| :-----------------------: | :---------: |
|      åå…­è¿›åˆ¶ï¼ˆHexï¼‰      |    0xff     |
|     åè¿›åˆ¶ï¼ˆDecimalï¼‰     |   98_222    |
|      å…«è¿›åˆ¶ï¼ˆOctalï¼‰      |    0o77     |
|     äºŒè¿›åˆ¶ï¼ˆBinaryï¼‰      | 0b1111_0000 |
| å­—èŠ‚ï¼ˆByteï¼Œä»…æ”¯æŒ`u8`ï¼‰  |    b'A'     |

Rust é»˜è®¤ä½¿ç”¨`i32`åˆå§‹åŒ–æ•´æ•°ã€‚

##### æµ®ç‚¹æ•°

Rust ä¸­æœ‰`f32`å’Œ`f64`ä¸¤ç§æµ®ç‚¹æ•°ç±»å‹ï¼Œåˆ†åˆ«å ç”¨ 32 bits å’Œ 64 bits çš„å¤§å°ã€‚Rust ä½¿ç”¨`f64`ä½œä¸ºæµ®ç‚¹æ•°çš„é»˜è®¤ç±»å‹ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç°ä»£ CPU ä¸­ï¼Œ64 ä½æµ®ç‚¹æ•°çš„è¿ç®—é€Ÿåº¦å’Œ 32 ä½åŸºæœ¬ç›¸åŒï¼Œä½† 64 ä½æµ®ç‚¹æ•°ç²¾åº¦æ›´é«˜ã€‚

ç¤ºä¾‹ï¼š

```rust
let x = 1.0;		// f64
let y: f32 = 3.0;	// f32
```

æŒ‰ç…§ IEEE-754 æ ‡å‡†ï¼Œ`f32`ä¸ºå•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œ`f64`ä¸ºåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚

##### æ•°å€¼è¿ç®—

ç¤ºä¾‹ï¼š

```rust
fn main() {
    // åŠ æ³• addition
    let sum = 5 + 10;

    // å‡æ³• subtraction
    let difference = 95.5 - 4.3;

    // ä¹˜æ³• multiplication
    let product = 4 * 30;

    // é™¤æ³• division
    let quotient = 56.7 / 32.2;

    // å–ä½™ remainder
    let remainder = 43 % 5;
}
```

##### å¸ƒå°”å€¼

å¸ƒå°”å€¼çš„å¤§å°ä¸º 1 byteï¼Œæœ‰`true`å’Œ`false`è¿™ä¸¤ä¸ªå¯èƒ½çš„å€¼ã€‚

ç¤ºä¾‹ï¼š

```rust
let t = true;
let f: bool = false; // æ˜¾å¼æŒ‡å®šç±»å‹
```

##### å­—ç¬¦ç±»å‹

Rust ä¸­å­—ç¬¦ç±»å‹ï¼ˆ`char`ï¼‰ä½¿ç”¨å•å¼•å·å­—é¢é‡ï¼Œç”¨äºå­˜å‚¨å•ä¸ªå­—ç¬¦ã€‚Rust çš„`char`ç±»å‹åœ¨ç¼–ç¨‹è¯­è¨€ä¸­æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒçš„å¤§å°ä¸º 4 bytesï¼Œè¡¨ç¤ºä¸€ä¸ª Unicode æ ‡é‡å€¼ã€‚

ç¤ºä¾‹ï¼š

```rust
let c = 'z';
let z = 'â„¤';
let æ±‰ = 'å¥½';
let heart_eyed_cat = 'ğŸ˜»';
```

å¯ä»¥æ³¨æ„åˆ°ï¼ŒRust æ˜¯æ”¯æŒéè‹±æ–‡å˜é‡åçš„ã€‚

#### å¤åˆç±»å‹

å¤åˆç±»å‹æ˜¯ç”±å¤šä¸ªæ•°æ®ç±»å‹ç»„åˆæˆçš„ä¸€ç§æ•°æ®ç±»å‹ï¼ŒRust æœ‰ä¸¤ç§åŸå§‹çš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆ_Tuple_ï¼‰å’Œæ•°ç»„ï¼ˆ_Array_ï¼‰ã€‚

##### Tuple

Tuple çš„å¤§å°å›ºå®šï¼Œä¸€æ—¦è¢«å£°æ˜ï¼Œå…¶å¤§å°å°±ä¸å¯ä¿®æ”¹ã€‚

åˆ›å»º Tupleï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

ä¸Šé¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªç”±`i32`ï¼Œ`f64`å’Œ`u8`ä¸‰ä¸ªç±»å‹ç»„æˆçš„ Tuple `tup`ï¼Œå¹¶åˆå§‹åŒ–å…¶å€¼ã€‚

ä» Tuple å–å€¼ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("The value of x is: {}", x); // The value of x is: 500
    println!("The value of y is: {}", y); // The value of y is: 6.4
    println!("The value of z is: {}", z); // The value of z is: 1
}
```

ç±»ä¼¼`let (x, y, z) = tup`å°†ä¸€ä¸ª tuple èµ‹å€¼ç»™å¤šä¸ªå˜é‡çš„ç”¨æ³•è¢«ç§°ä¸ºè§£æ„ï¼ˆ_destructuring_ï¼‰ï¼Œ

è¿˜å¯ä»¥ç›´æ¥æ ¹æ®ä¸‹æ ‡å–å€¼ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    println!("The value of x is: {}", tup.0); // The value of x is: 500
    println!("The value of y is: {}", tup.1); // The value of y is: 6.4
    println!("The value of z is: {}", tup.2); // The value of z is: 1
}
```

##### Array

Array å’Œ Tuple çš„å·®åˆ«å¾ˆå¤§ï¼Œå‰è€…åªèƒ½åŒ…å«ç›¸åŒæ•°æ®ç±»å‹çš„å…ƒç´ ï¼Œåè€…åˆ™ä¸ç„¶ã€‚ä¸è¿‡ Rust ä¸­çš„ Array å’Œ Tuple ä¸€æ ·æ˜¯å›ºå®šé•¿åº¦çš„ï¼Œä¸å¯æ”¹å˜ã€‚

Array çš„åˆå§‹åŒ–ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];	// åˆå§‹åŒ–
    let b: [i32; 5] = [1, 2, 3, 4, 5];	// [type; length]
}
```

Array ç‰¹æ®Šåœ¨äºå…¶ä¸€èˆ¬åˆ†é…åœ¨å†…å­˜ç©ºé—´ä¸­çš„æ ˆï¼ˆstackï¼‰ä¸Šè€Œä¸æ˜¯å †ï¼ˆheapï¼‰ä¸Šï¼Œè¿™åœ¨åæ–‡ä¼šæ·±å…¥è®¨è®ºã€‚å½“éœ€è¦å›ºå®šé•¿åº¦çš„ä¸€ç³»åˆ—å…ƒç´ æ—¶ï¼Œç”¨ Array ä¼šæ¯”è¾ƒåˆé€‚ã€‚Rust ä¸­è¿˜æœ‰ä¸€ç§å¯å˜çš„æ•°ç»„ï¼Œå³**vector**ï¼Œä½†å®ƒæ˜¯ç”±æ ‡å‡†åº“æä¾›çš„è€Œä¸æ˜¯ Rust è¯­è¨€æœ¬èº«ï¼Œä¸€èˆ¬æ¥è¯´ vector ä¼šæ›´å¸¸ç”¨ä¸€äº›ã€‚

Array çš„å£°æ˜å’Œå–å€¼ï¼š

å’Œå…¶ä»–å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ç›¸åŒï¼ŒRust ä¸­å–æ•°ç»„å…ƒç´ ä½¿ç”¨ä¸‹æ ‡ï¼Œå¦‚`a[0]`ã€‚

```rust
fn main() {
	let a: [isize; 5];	// å£°æ˜é•¿åº¦ä¸º 5 çš„ç©ºæ•°ç»„
    println!("{}", a[0]);
}
```

ä¸Šé¢çš„ä»£ç ä¼šç›´æ¥ç¼–è¯‘ä¸é€šè¿‡ï¼ŒæŠ¥`use of possibly-uninitialized`é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸º Rust ç¦æ­¢ä½¿ç”¨æœªåˆå§‹åŒ–çš„å˜é‡ï¼Œæ”¹æˆä¸‹é¢çš„ä»£ç å°±å¯ä»¥äº†ï¼š

```rust
fn main() {
    let a: [isize; 5];
    a = [3; 5];	// å°†ä¸€ä¸ªé•¿åº¦ä¸º 5ï¼Œå†…å®¹å…¨éƒ¨ä¸º 3 çš„æ•°ç»„èµ‹ç»™å˜é‡ a
    println!("{}", a[0]); // 3
}
```

`a = [3; 5]`ç­‰åŒäº`a = [3, 3, 3, 3, 3]`ã€‚

æˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä»¶äº‹æƒ…ï¼šArray å˜é‡é»˜è®¤æ˜¯ _mutable_ çš„ï¼Œä¸éœ€è¦ä½¿ç”¨`mut`ä¿®é¥°å°±å¯ä»¥å¯¹å…¶é‡æ–°èµ‹å€¼ã€‚

å¦‚æœæˆ‘ä»¬è®¿é—®æ•°ç»„æ—¶è¶Šç•Œä¼šæ€ä¹ˆæ ·ï¼Ÿåœ¨æŸäº›ç¼–ç¨‹è¯­è¨€ä¸­è¶Šç•Œå¹¶ä¸ä¼šé€ æˆç¨‹åºæœ¬èº«åœæ­¢æˆ–å¼‚å¸¸ï¼Œä½†ä¼šç»™å†…å­˜ä¸Šçš„æ•°æ®é€ æˆç ´åã€‚åœ¨ Rust ä¸­ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ£€æŸ¥æ•°ç»„è®¿é—®çš„ä¸‹æ ‡æ˜¯å¦è¶Šç•Œï¼Œå¦‚æœè¶Šç•Œåˆ™æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚å½“ä¸‹æ ‡çš„å€¼åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰ä¼šç¡®å®šï¼ˆå¦‚æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ä¸‹æ ‡å€¼ï¼‰æ—¶ï¼Œè¶Šç•Œä¼šå¯¼è‡´ç¨‹åº **panic**ï¼Œå¹¶éšä¹‹ä¸­æ­¢ã€‚

### å‡½æ•°

åœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå‡½æ•°éƒ½æ˜¯ç›¸å½“é‡è¦çš„å­˜åœ¨ï¼ŒRust ä¹Ÿä¸ä¾‹å¤–ï¼Œå‡½æ•°çš„ä½¿ç”¨æ— å¤„ä¸åœ¨ï¼Œæ¯”å¦‚å‰æ–‡ä¸­å¤§é‡ä½¿ç”¨çš„`main`å‡½æ•°ã€‚

#### å‘½åè§„èŒƒ

Rust ä½¿ç”¨`fn`å…³é”®å­—å£°æ˜å‡½æ•°ï¼Œå¹¶ä½¿ç”¨ _snake case_ å‘½åé£æ ¼ï¼Œæ‰€æœ‰çš„å‡½æ•°åä½¿ç”¨å°å†™å­—æ¯å¹¶ä½¿ç”¨`_`åˆ†éš”ã€‚Rust å¹¶ä¸åœ¨ä¹å‡½æ•°çš„å®šä¹‰ä½ç½®ï¼Œæ— è®ºå…¶åœ¨ä»£ç ä¸­æ˜¯ä½äº`main`å‡½æ•°ä¹‹å‰è¿˜æ˜¯ä¹‹åã€‚

```rust
fn sample_func() {
    println!("Sample function.");
}

fn hello_world() {
    println!("Hello world.");
}
```

è°ƒç”¨å‡½æ•°ä¹Ÿå¾ˆç®€å•ï¼Œä¾‹å¦‚`sample_func()`ï¼š

```rust
fn main() {
    hello_world();	// Hello world.
}

fn hello_world() {
    println!("Hello world.");
}
```

#### å‡½æ•°å‚æ•°
