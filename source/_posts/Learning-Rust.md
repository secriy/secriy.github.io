---
title: Learning Rust
date: 2021-09-18 14:25:28
categories: å­¦ä¹ ç¬”è®°
mathjax: true
tags:
  - Rust
  - Programming
references:
  - title: The Rust Programming Language
    url: https://doc.rust-lang.org/book/
---

{% noteblock quote cyan %}

æœ¬æ–‡æ ¹æ®[The Rust Programming Language](https://doc.rust-lang.org/book/)ç¿»è¯‘æ€»ç»“è€Œæˆï¼Œå¤§å¤šå†…å®¹çº¯ç²¹æ˜¯å¯¹è¯¥ä¹¦çš„ç¿»è¯‘ï¼Œä½†æŒ‰ç…§æˆ‘ä¸ªäººçš„å­¦ä¹ è·¯çº¿ä»¥åŠç»ƒä¹ å¢åˆ äº†ä¸€äº›å†…å®¹ï¼ŒåŒæ—¶ä¹Ÿå‚è€ƒäº†å…¶ä»–æ–‡æ¡£å¯¹éœ€è¦æ·±å…¥è®¨è®ºçš„éƒ¨åˆ†è¿›è¡Œäº†ä»‹ç»ã€‚æœ¬æ–‡å¯¹äºæœ‰å…¶ä»–ç¼–ç¨‹è¯­è¨€ç»éªŒçš„åŒå­¦æ¥è¯´æ¯”è¾ƒå®¹æ˜“æ¥å—ï¼Œå®¹æ˜“å¼•èµ·æ­§ä¹‰çš„è‹±æ–‡ç¿»è¯‘éƒ½ä¼šæ ‡æ³¨åŸæ–‡ã€‚ç”±äºæœ¬æ–‡å®Œå…¨ç›´æ¥å‚è€ƒå®˜æ–¹æ•™ç¨‹ç­‰è‹±æ–‡æ–‡çŒ®ï¼Œå¯ä»¥ç¡®ä¿å†…å®¹ä¸å­˜åœ¨è½¬ç»å¤šäººä¹‹æ‰‹è€Œå‡ºç°çš„åå·®ã€‚ä½†å—é™äºä¸ªäººçŸ¥è¯†æ°´å¹³ï¼Œéš¾å…å‡ºç°ç–æ¼é”™è¯¯ï¼Œçƒ¦è¯·å‘ŠçŸ¥ã€‚

{% endnoteblock %}

<!-- more -->

## åŸºç¡€æ¦‚å¿µ

### å˜é‡å’Œå¯å˜æ€§

#### å˜é‡

Rust ä¸­å˜é‡æœ‰å¯å˜å˜é‡ï¼ˆ _mutable variable_ ï¼‰å’Œä¸å¯å˜å˜é‡ï¼ˆ _immutable variable_ ï¼‰çš„åŒºåˆ†ï¼Œçœ‹å¦‚ä¸‹çš„ä»£ç ï¼š

```rust
fn main() {
    let x = 5;
    println!("{}", x);
    x = 6;
    println!("{}", x);
}
```

ä½¿ç”¨ `cargo run`è¿è¡Œï¼š

```shell
cargo run
   Compiling hello-rust v0.1.0 (H:\Coding\Rust\hello-rust)
error[E0384]: cannot assign twice to immutable variable `x`
 --> src\main.rs:4:5
  |
2 |     let x = 5;
  |         -
  |         |
  |         first assignment to `x`
  |         help: consider making this binding mutable: `mut x`
3 |     println!("{}", x); // 5
4 |     x = 6;
  |     ^^^^^ cannot assign twice to immutable variable

error: aborting due to previous error

For more information about this error, try `rustc --explain E0384`.
error: could not compile `hello-rust`

To learn more, run the command again with --verbose.
```

ä¸Šé¢çš„é”™è¯¯è¡¨æ˜ï¼Œå˜é‡`x`æ— æ³•äºŒæ¬¡èµ‹å€¼ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª _immutable variable_ ã€‚å¦å¤–æŠ¥é”™è¿˜è¯´æ˜ï¼ŒRust åœ¨ç¼–è¯‘æœŸé—´å°±å·²ç»å¯¹ç¨‹åºå¯èƒ½å‡ºç°çš„æŸäº›é—®é¢˜ä½œäº†åˆ¤æ–­ï¼Œå¦‚æœä¸é€šè¿‡æ£€æŸ¥åˆ™ç¼–è¯‘å¤±è´¥ã€‚

```rust
fn main() {
    let mut x = 5;
    println!("{}", x);	// 5
    x = 6;
    println!("{}", x);	// 6
}
```

é€šè¿‡`let mut x = 5`çš„æ–¹å¼å°†`x`åˆå§‹åŒ–ä¸ºå¯å˜å˜é‡ã€‚

#### å¸¸é‡

å¸¸é‡çš„å£°æ˜ä½¿ç”¨å¦‚ä¸‹å½¢å¼çš„è¯­å¥ï¼š

```rust
// const [NAME]: [DATA_TYPE] = [DATA];
const PI: f32 = 3.14159;
```

#### å·®åˆ«

å¸¸é‡å’Œå˜é‡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ

1.  å¸¸é‡æ— æ³•ä½¿ç”¨`mut`ä¿®é¥°ï¼Œå®ƒå§‹ç»ˆæ˜¯ä¸å¯å˜çš„ï¼›
2.  å¸¸é‡ä½¿ç”¨`const`å£°æ˜ï¼Œå˜é‡ä½¿ç”¨`let`ï¼›
3.  å¸¸é‡å¿…é¡»å§‹ç»ˆæ³¨æ˜å…¶æ•°æ®ç±»å‹ï¼›
4.  å¸¸é‡å¯ä»¥å†ä»»ä½•èŒƒå›´å£°æ˜ï¼Œå¦‚å…¨å±€å¸¸é‡ã€å±€éƒ¨å¸¸é‡ï¼›
5.  å¸¸é‡æ˜¯é€šè¿‡å¸¸é‡è¡¨è¾¾å¼ç¡®å®šå€¼çš„ï¼Œåœ¨ç¼–è¯‘å™¨å…¶å€¼å°±ä¼šè¢«ç¡®å®šï¼Œè€Œå˜é‡çš„å€¼å¯ä»¥åœ¨è¿è¡Œæ—¶èµ‹äºˆã€‚

#### Shadowing

Rust æ”¯æŒä½¿ç”¨`let`å…³é”®å­—è¿›è¡ŒåŒåå˜é‡çš„é‡å¤åˆå§‹åŒ–ï¼š

```rust
fn main() {
    let x = 5;

    let x = x + 1;

    let x = x * 2;

    println!("The value of x is: {}", x);	// The value of x is: 12
}
```

ç”šè‡³å¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªä¸åŒç±»å‹çš„åŒåå˜é‡ï¼š

```rust
fn main() {
    let string = "abc";

    let string = string.len();

    println!("The length of string is: {}", string)	// The length of string is: 3
}
```

ç¬¬ä¸€ä¸ª`string`å’Œç¬¬äºŒä¸ª`string`å¹¶éåŒä¸€ä¸ªå˜é‡ï¼Œå®ƒä»¬åªæ˜¯åŒåï¼Œä¸åŒäº`mut`å˜é‡ï¼Œå…¶ä¸¤ä¸ªåŒåå˜é‡ä¹‹é—´æ˜¯æ²¡æœ‰å…³è”çš„ã€‚æŒ‰ Rust å®˜æ–¹çš„è¯´æ³•ï¼Œç¬¬ä¸€ä¸ªå˜é‡è¢«ç¬¬äºŒä¸ªå˜é‡é®è”½ï¼ˆ _shadowed_ ï¼‰äº†ï¼Œå› æ­¤è¿™ä¸ªæ¦‚å¿µåœ¨ Rust ä¸­å«åš**Shadowing**ã€‚

å¦‚æœå¯¹`mut`å˜é‡èµ‹æ–°å€¼ï¼š

```rust
fn main() {
    let mut string = "abc";

	string = string.len();

    println!("The length of string is: {}", string)
}
```

ä¸Šé¢çš„ä»£ç åœ¨ç¼–è¯‘æ—¶å°±æ— æ³•é€šè¿‡ï¼Œå› ä¸ºå…¶ç±»å‹ä¸åŒ¹é…ã€‚

çœ‹ä¸‹é¢ä¸€æ®µä»£ç ï¼Œå¯¹`mut`å˜é‡è¿›è¡Œäº†é‡æ–°èµ‹å€¼ï¼š

```rust
fn main() {
    let mut string = "abc";

    string = "xyz";

    println!("The string is: {}", string)	// The string is: xyz
}
```

è¿™æ®µä»£ç èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯ç¼–è¯‘æœŸé—´ä¼šè¾“å‡º`warning`ï¼Œå³è­¦å‘Šä¿¡æ¯ã€‚è¿™æ˜¯å› ä¸º`"abc"`å­—ç¬¦ä¸²å¹¶æ²¡æœ‰ä½¿ç”¨å°±è¢«`"xyz"`è¦†ç›–äº†ï¼Œæ‰€ä»¥å‡ºç°è­¦å‘Šï¼Œä½†è¿™å¹¶ä¸å½±å“ç¨‹åºçš„æ‰§è¡Œã€‚

### æ•°æ®ç±»å‹

æ•°æ®ç±»å‹æ˜¯é™æ€ç±»å‹ç›¸å½“é‡è¦çš„éƒ¨åˆ†ï¼ŒRust ä½œä¸ºä¸€ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå…¶æ¯ä¸€ä¸ªå€¼éƒ½æœ‰æŒ‡å®šçš„ç±»å‹ï¼Œæ‰€æœ‰å˜é‡çš„ç±»å‹åœ¨ç¼–è¯‘æœŸé—´å°±å·²ç»ç¡®å®šäº†ã€‚

Rust ä¸­æ•°æ®ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ ‡é‡ç±»å‹ï¼ˆscalarï¼‰ä»¥åŠå¤åˆç±»å‹ï¼ˆcompoundï¼‰ã€‚

#### æ ‡é‡ç±»å‹

æ ‡é‡ç±»å‹æ˜¯ç®€å•ç±»å‹ï¼Œä»£è¡¨äº†å•ä¸ªå€¼ã€‚Rust ä¸­æœ‰å››ç§æ ‡é‡ç±»å‹ï¼š

- æ•´æ•°
- æµ®ç‚¹æ•°
- å¸ƒå°”å€¼
- å­—ç¬¦

##### æ•´æ•°

Rust ä¸­çš„æ•´æ•°ç±»å‹å¦‚ä¸‹è¡¨ï¼š

| é•¿åº¦ï¼ˆLengthï¼‰ | æœ‰ç¬¦å·ï¼ˆSignedï¼‰ | æ— ç¬¦å·ï¼ˆUnsignedï¼‰ |
| :------------: | :--------------: | :----------------: |
|     8-bit      |        i8        |         u8         |
|     16-bit     |       i16        |        u16         |
|     32-bit     |       i32        |        u32         |
|     64-bit     |       i64        |        u64         |
|    128-bit     |       i128       |        u128        |
|      arch      |      isize       |       usize        |

`arch` å³ architectureï¼Œè¡¨ç¤º CPU æ¶æ„çš„ä½æ•°ï¼Œå¦‚ 64-bit æœºå™¨ä¸Šå°±æ˜¯ 64 bitsï¼Œ32-bit æœºå™¨ä¸Šå°±æ˜¯ 32 bitsï¼Œè¿™åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€é‡Œä¹Ÿå¾ˆå¸¸è§ï¼Œå¦‚ C ä¸­çš„`int`ç±»å‹ã€‚

æ•´æ•°ç±»å‹çš„å­—é¢é‡è¡¨ç¤ºå¦‚ä¸‹è¡¨ï¼š

| å­—é¢é‡ï¼ˆNumber literalsï¼‰ |    ç¤ºä¾‹     |
| :-----------------------: | :---------: |
|      åå…­è¿›åˆ¶ï¼ˆHexï¼‰      |    0xff     |
|     åè¿›åˆ¶ï¼ˆDecimalï¼‰     |   98_222    |
|      å…«è¿›åˆ¶ï¼ˆOctalï¼‰      |    0o77     |
|     äºŒè¿›åˆ¶ï¼ˆBinaryï¼‰      | 0b1111_0000 |
| å­—èŠ‚ï¼ˆByteï¼Œä»…æ”¯æŒ`u8`ï¼‰  |    b'A'     |

Rust é»˜è®¤ä½¿ç”¨`i32`åˆå§‹åŒ–æ•´æ•°ã€‚

##### æµ®ç‚¹æ•°

Rust ä¸­æœ‰`f32`å’Œ`f64`ä¸¤ç§æµ®ç‚¹æ•°ç±»å‹ï¼Œåˆ†åˆ«å ç”¨ 32 bits å’Œ 64 bits çš„å¤§å°ã€‚Rust ä½¿ç”¨`f64`ä½œä¸ºæµ®ç‚¹æ•°çš„é»˜è®¤ç±»å‹ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç°ä»£ CPU ä¸­ï¼Œ64 ä½æµ®ç‚¹æ•°çš„è¿ç®—é€Ÿåº¦å’Œ 32 ä½åŸºæœ¬ç›¸åŒï¼Œä½† 64 ä½æµ®ç‚¹æ•°ç²¾åº¦æ›´é«˜ã€‚

ç¤ºä¾‹ï¼š

```rust
let x = 1.0;		// f64
let y: f32 = 3.0;	// f32
```

æŒ‰ç…§ IEEE-754 æ ‡å‡†ï¼Œ`f32`ä¸ºå•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œ`f64`ä¸ºåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚

##### æ•°å€¼è¿ç®—

ç¤ºä¾‹ï¼š

```rust
fn main() {
    // åŠ æ³• addition
    let sum = 5 + 10;

    // å‡æ³• subtraction
    let difference = 95.5 - 4.3;

    // ä¹˜æ³• multiplication
    let product = 4 * 30;

    // é™¤æ³• division
    let quotient = 56.7 / 32.2;

    // å–ä½™ remainder
    let remainder = 43 % 5;
}
```

##### å¸ƒå°”å€¼

å¸ƒå°”å€¼çš„å¤§å°ä¸º 1 byteï¼Œæœ‰`true`å’Œ`false`è¿™ä¸¤ä¸ªå¯èƒ½çš„å€¼ã€‚

ç¤ºä¾‹ï¼š

```rust
let t = true;
let f: bool = false; // æ˜¾å¼æŒ‡å®šç±»å‹
```

##### å­—ç¬¦ç±»å‹

Rust ä¸­å­—ç¬¦ç±»å‹ï¼ˆ`char`ï¼‰ä½¿ç”¨å•å¼•å·å­—é¢é‡ï¼Œç”¨äºå­˜å‚¨å•ä¸ªå­—ç¬¦ã€‚Rust çš„`char`ç±»å‹åœ¨ç¼–ç¨‹è¯­è¨€ä¸­æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒçš„å¤§å°ä¸º 4 bytesï¼Œè¡¨ç¤ºä¸€ä¸ª Unicode æ ‡é‡å€¼ã€‚

ç¤ºä¾‹ï¼š

```rust
let c = 'z';
let z = 'â„¤';
let æ±‰ = 'å¥½';
let heart_eyed_cat = 'ğŸ˜»';
```

å¯ä»¥æ³¨æ„åˆ°ï¼ŒRust æ˜¯æ”¯æŒéè‹±æ–‡å˜é‡åçš„ã€‚

#### å¤åˆç±»å‹

å¤åˆç±»å‹æ˜¯ç”±å¤šä¸ªæ•°æ®ç±»å‹ç»„åˆæˆçš„ä¸€ç§æ•°æ®ç±»å‹ï¼ŒRust æœ‰ä¸¤ç§åŸå§‹çš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆTupleï¼‰å’Œæ•°ç»„ï¼ˆArrayï¼‰ã€‚

##### Tuple

Tuple çš„å¤§å°å›ºå®šï¼Œä¸€æ—¦è¢«å£°æ˜ï¼Œå…¶å¤§å°å°±ä¸å¯ä¿®æ”¹ã€‚

åˆ›å»º Tupleï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

ä¸Šé¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªç”±`i32`ï¼Œ`f64`å’Œ`u8`ä¸‰ä¸ªç±»å‹ç»„æˆçš„ Tuple `tup`ï¼Œå¹¶åˆå§‹åŒ–å…¶å€¼ã€‚

ä» Tuple å–å€¼ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("The value of x is: {}", x); // The value of x is: 500
    println!("The value of y is: {}", y); // The value of y is: 6.4
    println!("The value of z is: {}", z); // The value of z is: 1
}
```

ç±»ä¼¼`let (x, y, z) = tup`å°†ä¸€ä¸ª tuple èµ‹å€¼ç»™å¤šä¸ªå˜é‡çš„ç”¨æ³•è¢«ç§°ä¸ºè§£æ„ï¼ˆ _destructuring_ ï¼‰ï¼Œ

è¿˜å¯ä»¥ç›´æ¥æ ¹æ®ä¸‹æ ‡å–å€¼ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    println!("The value of x is: {}", tup.0); // The value of x is: 500
    println!("The value of y is: {}", tup.1); // The value of y is: 6.4
    println!("The value of z is: {}", tup.2); // The value of z is: 1
}
```

##### Array

Array å’Œ Tuple çš„å·®åˆ«å¾ˆå¤§ï¼Œå‰è€…åªèƒ½åŒ…å«ç›¸åŒæ•°æ®ç±»å‹çš„å…ƒç´ ï¼Œåè€…åˆ™ä¸ç„¶ã€‚ä¸è¿‡ Rust ä¸­çš„ Array å’Œ Tuple ä¸€æ ·æ˜¯å›ºå®šé•¿åº¦çš„ï¼Œä¸å¯æ”¹å˜ã€‚

Array çš„åˆå§‹åŒ–ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];	// åˆå§‹åŒ–
    let b: [i32; 5] = [1, 2, 3, 4, 5];	// [type; length]
}
```

Array ç‰¹æ®Šåœ¨äºå…¶ä¸€èˆ¬åˆ†é…åœ¨å†…å­˜ç©ºé—´ä¸­çš„æ ˆï¼ˆstackï¼‰ä¸Šè€Œä¸æ˜¯å †ï¼ˆheapï¼‰ä¸Šï¼Œè¿™åœ¨åæ–‡ä¼šæ·±å…¥è®¨è®ºã€‚å½“éœ€è¦å›ºå®šé•¿åº¦çš„ä¸€ç³»åˆ—å…ƒç´ æ—¶ï¼Œç”¨ Array ä¼šæ¯”è¾ƒåˆé€‚ã€‚Rust ä¸­è¿˜æœ‰ä¸€ç§å¯å˜çš„æ•°ç»„ï¼Œå³**vector**ï¼Œä½†å®ƒæ˜¯ç”±æ ‡å‡†åº“æä¾›çš„è€Œä¸æ˜¯ Rust è¯­è¨€æœ¬èº«ï¼Œä¸€èˆ¬æ¥è¯´ vector ä¼šæ›´å¸¸ç”¨ä¸€äº›ã€‚

Array çš„å£°æ˜å’Œå–å€¼ï¼š

å’Œå…¶ä»–å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ç›¸åŒï¼ŒRust ä¸­å–æ•°ç»„å…ƒç´ ä½¿ç”¨ä¸‹æ ‡ï¼Œå¦‚`a[0]`ã€‚

```rust
fn main() {
	let a: [isize; 5];	// å£°æ˜é•¿åº¦ä¸º 5 çš„ç©ºæ•°ç»„
    println!("{}", a[0]);
}
```

ä¸Šé¢çš„ä»£ç ä¼šç›´æ¥ç¼–è¯‘ä¸é€šè¿‡ï¼ŒæŠ¥`use of possibly-uninitialized`é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸º Rust ç¦æ­¢ä½¿ç”¨æœªåˆå§‹åŒ–çš„å˜é‡ï¼Œæ”¹æˆä¸‹é¢çš„ä»£ç å°±å¯ä»¥äº†ï¼š

```rust
fn main() {
    let a: [isize; 5];
    a = [3; 5];	// å°†ä¸€ä¸ªé•¿åº¦ä¸º 5ï¼Œå†…å®¹å…¨éƒ¨ä¸º 3 çš„æ•°ç»„èµ‹ç»™å˜é‡ a
    println!("{}", a[0]); // 3
}
```

`a = [3; 5]`ç­‰åŒäº`a = [3, 3, 3, 3, 3]`ã€‚

æˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä»¶äº‹æƒ…ï¼šArray å˜é‡é»˜è®¤æ˜¯ _mutable_ çš„ï¼Œä¸éœ€è¦ä½¿ç”¨`mut`ä¿®é¥°å°±å¯ä»¥å¯¹å…¶é‡æ–°èµ‹å€¼ã€‚

å¦‚æœæˆ‘ä»¬è®¿é—®æ•°ç»„æ—¶è¶Šç•Œä¼šæ€ä¹ˆæ ·ï¼Ÿåœ¨æŸäº›ç¼–ç¨‹è¯­è¨€ä¸­è¶Šç•Œå¹¶ä¸ä¼šé€ æˆç¨‹åºæœ¬èº«åœæ­¢æˆ–å¼‚å¸¸ï¼Œä½†ä¼šç»™å†…å­˜ä¸Šçš„æ•°æ®é€ æˆç ´åã€‚åœ¨ Rust ä¸­ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ£€æŸ¥æ•°ç»„è®¿é—®çš„ä¸‹æ ‡æ˜¯å¦è¶Šç•Œï¼Œå¦‚æœè¶Šç•Œåˆ™æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚å½“ä¸‹æ ‡çš„å€¼åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰ä¼šç¡®å®šï¼ˆå¦‚æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ä¸‹æ ‡å€¼ï¼‰æ—¶ï¼Œè¶Šç•Œä¼šå¯¼è‡´ç¨‹åº **panic**ï¼Œå¹¶éšä¹‹ä¸­æ­¢ã€‚

### å‡½æ•°

åœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå‡½æ•°éƒ½æ˜¯ç›¸å½“é‡è¦çš„å­˜åœ¨ï¼ŒRust ä¹Ÿä¸ä¾‹å¤–ï¼Œå‡½æ•°çš„ä½¿ç”¨æ— å¤„ä¸åœ¨ï¼Œæ¯”å¦‚å‰æ–‡ä¸­å¤§é‡ä½¿ç”¨çš„`main`å‡½æ•°ã€‚

#### å‘½åè§„èŒƒ

Rust ä½¿ç”¨`fn`å…³é”®å­—å£°æ˜å‡½æ•°ï¼Œå¹¶ä½¿ç”¨ snake case å‘½åé£æ ¼ï¼Œæ‰€æœ‰çš„å‡½æ•°åä½¿ç”¨å°å†™å­—æ¯å¹¶ä½¿ç”¨`_`åˆ†éš”ã€‚Rust å¹¶ä¸åœ¨ä¹å‡½æ•°çš„å®šä¹‰ä½ç½®ï¼Œæ— è®ºå…¶åœ¨ä»£ç ä¸­æ˜¯ä½äº`main`å‡½æ•°ä¹‹å‰è¿˜æ˜¯ä¹‹åã€‚

```rust
fn sample_func() {
    println!("Sample function.");
}

fn hello_world() {
    println!("Hello world.");
}
```

è°ƒç”¨å‡½æ•°ä¹Ÿå¾ˆç®€å•ï¼Œä¾‹å¦‚`sample_func()`ï¼š

```rust
fn main() {
    hello_world();	// Hello world.
}

fn hello_world() {
    println!("Hello world.");
}
```

#### å‡½æ•°å‚æ•°

å‡½æ•°å‚æ•°ç”¨æ³•ï¼š

```rust
fn main() {
    another_function(5);
}

fn another_function(x: i32) {
    println!("The value of x is: {}", x);	// The value of x is: 5
}
```

å¤šä¸ªå‚æ•°ï¼š

```rust
fn main() {
    another_function(5, 6);
}

fn another_function(x: i32, y: i32) {
    println!("The value of x is: {}", x);	// The value of x is: 5
    println!("The value of y is: {}", y);	// The value of y is: 6
}
```

å‡½æ•°çš„æ¯ä¸ªå‚æ•°éƒ½å¿…é¡»æŒ‡æ˜å…¶ç±»å‹ã€‚

#### å‡½æ•°è¿”å›å€¼

å‡½æ•°å¯ä»¥å‘è°ƒç”¨å®ƒä»¬çš„ä»£ç è¿”å›å€¼ã€‚æˆ‘ä»¬ä¸å‘½åè¿”å›å€¼ï¼Œä½†åœ¨ç®­å¤´ï¼ˆ->ï¼‰åé¢å£°æ˜å®ƒä»¬çš„ç±»å‹ã€‚åœ¨ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›å€¼ä¸å‡½æ•°ä½“å—ä¸­æœ€ç»ˆè¡¨è¾¾å¼çš„å€¼åŒä¹‰ã€‚é€šè¿‡ä½¿ç”¨ return å…³é”®å­—å¹¶æŒ‡å®šå€¼ï¼Œå¯ä»¥æå‰ä»å‡½æ•°è¿”å›ï¼Œä½†å¤§å¤šæ•°å‡½æ•°éšå¼è¿”å›æœ€åä¸€ä¸ªè¡¨è¾¾å¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè¿”å›å€¼çš„å‡½æ•°ç¤ºä¾‹ï¼š

Rust ä¸­å‡½æ•°è¿”å›å€¼æ˜¯æ— åçš„ï¼Œåªéœ€è¦æŒ‡å®šå…¶ç±»å‹ï¼š

```rust
fn five() -> i32 {
    5
}

fn plus_one(x: i32) -> i32 {
    x + 1
}

fn main() {
    let mut x = five();
    x = plus_one(x);

    println!("The value of x is: {}", x);	// The value of x is: 6
}
```

æ³¨æ„ï¼Œä½œä¸ºå‡½æ•°è¿”å›å€¼çš„è¯­å¥ï¼Œå…¶åæ˜¯æ²¡æœ‰`;`çš„ï¼Œå¦‚ä¸Šé¢çš„`5`å’Œ`x + 1`ï¼ŒåŠ ä¸Šåˆ†å·å°±å˜æˆäº†æ™®é€šè¯­å¥ï¼Œè€Œä¸æ˜¯è¿”å›å€¼ã€‚

`plus_one`å‡½æ•°è¿˜å¯ä»¥æ”¹æˆå¦‚ä¸‹çš„å½¢å¼ï¼š

```rust
fn plus_one(mut x: i32) -> i32 {
    x = x + 1;
    x
}
```

è¿™å’ŒåŸæ¥çš„`plus_one`å‡½æ•°æ˜¯ç­‰ä»·çš„ï¼Œåªä¸è¿‡ä½¿ç”¨äº†`mut`ä¿®é¥°ç¬¦è®©`x`å¯å˜ã€‚

### æ³¨é‡Š

æ³¨é‡Šå¾ˆç®€å•ï¼Œä¾‹å¦‚å•è¡Œæ³¨é‡Šï¼š

```rust
// This is a comment.
```

å¤šè¡Œæ³¨é‡Šï¼š

```rust
// Multiple lines
// comments.
```

```rust
fn main() {
    println!("Hello World!"); // Hello World!
}
```

Rust ä¸­è¿˜æœ‰ä¸€ç§æ–‡æ¡£æ³¨é‡Šï¼Œä½†æš‚æ—¶ç”¨ä¸åˆ°ï¼Œåœ¨ä¹‹åä¼šä»‹ç»ã€‚

### æ§åˆ¶æµ

æ§åˆ¶æµæ˜¯å¾ˆåŸºæœ¬çš„æ¦‚å¿µï¼ŒRust åŒæ ·åŒ…å«äº†å¤šç§åŸºæœ¬çš„æ§åˆ¶æµã€‚

#### æ¡ä»¶

Rust ä¸­`if`è¯­å¥ä¸éœ€è¦ä½¿ç”¨æ‹¬å·ï¼š

```rust
fn main() {
    let number = 3;

    if number < 5 {
        println!("number < 5");	// number < 5
    } else {
        println!("number >= 5");
    }
}
```

åœ¨ Rust ä¸­ï¼Œ`if`è¡¨è¾¾å¼åªèƒ½ç”¨å¸ƒå°”å€¼ä½œä¸ºæ¡ä»¶ï¼Œå³åªèƒ½åˆ¤æ–­å¸ƒå°”å˜é‡ä»¥åŠæ¡ä»¶è¡¨è¾¾å¼ã€‚

è¿˜å¯ä»¥ä½¿ç”¨`else if`è¡¨è¾¾å¼æ¥å¢åŠ åˆ†æ”¯ï¼Œåªæœ‰ä¸€ä¸ªåˆ†æ”¯ä¼šè¢«æ‰§è¡Œï¼Œä¸€æ—¦æŸä¸ªåˆ†æ”¯ä¸º`true`ï¼Œå°±ä¸ä¼šåˆ¤æ–­ä¸‹ä¸€ä¸ªåˆ†æ”¯ï¼š

```rust
fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");	// number is divisible by 3
    } else if number % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }
}
```

ä½¿ç”¨`if`è¯­å¥ï¼Œå¯ä»¥å®ç°ä¸‹é¢çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œç±»ä¼¼äºæŸäº›è¯­è¨€ä¸­çš„ä¸‰å…ƒè¿ç®—ç¬¦ï¼š

```rust
fn main() {
    let condition = true;
    let number = if condition { 5 } else { 6 };

    println!("The value of number is: {}", number);	// 5
}
```

å…¶ä¸­ï¼Œæ ¹æ®å‰é¢æœ‰å…³å‡½æ•°è¿”å›å€¼çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“`{}`ä¸­æ²¡æœ‰åˆ†å·ç»“å°¾çš„ä½œä¸ºè¿”å›å€¼ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥å†™å‡ºä¸‹é¢çš„è¯­å¥ï¼ŒåŒæ ·æ˜¯æ­£ç¡®çš„ï¼š

```rust
fn main() {
    let condition = true;
    let number = if condition {let x = 2; x+2} else {let x = 1; x+1};

    println!("The value of number is: {}", number);	// 4
}
```

ç„¶è€Œ`if`å’Œ`else`è¯­å¥å—çš„å€¼ä¸èƒ½ä¸ºä¸åŒç±»å‹ï¼Œè¿™æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ï¼Œè¿™æ˜¯å› ä¸º Rust éœ€è¦åœ¨ç¼–è¯‘æœŸç¡®å®šæ‰€æœ‰å˜é‡çš„ç±»å‹ï¼Œå¦‚æœ`if`å’Œ`else`èƒ½å¤Ÿå¾—åˆ°ä¸åŒç±»å‹çš„ç»“æœï¼Œé‚£ä¹ˆä¹Ÿå°±æ— æ³•çŸ¥é“å˜é‡`number`çš„ç±»å‹ã€‚ä¸è¿‡ï¼Œè¿™å¹¶ä¸ä»£è¡¨è¿™æ ·çš„å®ç°æ˜¯ä¸å¯èƒ½çš„ï¼Œå¦‚æœç¼–è¯‘å™¨å¿…é¡»è·Ÿè¸ªä»»ä½•å˜é‡çš„å¤šä¸ªå‡è®¾ç±»å‹ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†æ›´åŠ å¤æ‚ï¼Œå¯¹ä»£ç çš„ä¿è¯ä¹Ÿä¼šæ›´å°‘ã€‚

#### å¾ªç¯

Rust æœ‰ä¸‰ç§å¾ªç¯è¯­å¥ï¼Œ`loop`ã€`while`å’Œ`for`ã€‚

##### loop

ç®€è€Œè¨€ä¹‹ï¼Œ`loop`è¯­å¥å°±æ˜¯æ— é™å¾ªç¯ï¼Œå®ƒæ²¡æœ‰æ¡ä»¶è¯­å¥ï¼Œä¹Ÿå°±ä¸èƒ½åœ¨å¾ªç¯ä¸Šè®©å…¶é€€å‡ºã€‚ä½†æ˜¯`loop`å¯ä»¥é€šè¿‡å¾ªç¯ä½“å†…çš„è¯­å¥é€€å‡ºï¼š

```rust
fn main() {
    let mut count = 0;	// ç»Ÿè®¡å¾ªç¯æ¬¡æ•°
    loop {
        if count == 5 {break;}	// å½“ count ç­‰äº 5 åˆ™é€€å‡ºå¾ªç¯
        println!("hello");
        count += 1;	// æ¬¡æ•°åŠ ä¸€
    }
}
```

æ¯‹åº¸ç½®ç–‘ï¼Œä¸Šé¢çš„ä»£ç ä¼šè¾“å‡ºäº”è¡Œ`hello`ã€‚

å…³äº`loop`è¯­å¥è¿˜æœ‰ä¸€ç‚¹æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼Œå®ƒå¯ä»¥è¿”å›å€¼ï¼š

```rust
fn main() {
    let mut count = 0;
    let result = loop {
        if count == 5 {break count + 1;}
        println!("hello");
        count += 1;
    };
    println!("The value of result is: {}", result);	// The value of result is: 6
}
```

å¯ä»¥çœ‹åˆ°ï¼Œ`break`å…³é”®å­—åé¢è·Ÿè¿”å›å€¼ï¼Œå°±èƒ½èµ‹å€¼ç»™`result`ï¼Œå½“æ‰§è¡Œåˆ°`break`è¯­å¥å`loop`ç«‹å³è¿”å›äº†`count + 1`ã€‚

ç»“åˆå‰é¢çš„å†…å®¹ï¼Œå¯ä»¥çŸ¥é“ä¸‹é¢çš„ä»£ç ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼š

```rust
fn main() {
    let mut count = 0;
    let result = loop {
        if count == 5 {break {let x = 12; count + x};}
        println!("hello");
        count += 1;
    };
    println!("The value of result is: {}", result);	// The value of result is: 17
}
```

`{let x = 12; count + x}`çš„å€¼ä¸º`count + x`å³ 17ï¼Œé€šè¿‡`break`è¿”å›ç»™`result`ã€‚

##### While

å¾ªç¯è¯­å¥ä¸­å†™å¾ªç¯æ¡ä»¶å¯ä»¥è®©å¾ªç¯å¤„ç†æ›´ç®€å•ï¼ŒRust æä¾›äº†`while`å¾ªç¯æ”¯æŒæŒ‡å®šå¾ªç¯æ¡ä»¶ï¼š

```rust
fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{}!", number);

        number -= 1;
    }

    println!("LIFTOFF!!!");	// LIFTOFF!!!
}
```

è¿™å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€æ²¡ä»€ä¹ˆå¤§çš„åŒºåˆ«ï¼Œä¸å†èµ˜è¿°ã€‚

##### for

`for`å¾ªç¯ç”¨äºè¿­ä»£å…ƒç´ é›†åˆï¼Œå¦‚æ•°ç»„ï¼ˆArrayï¼‰ï¼Œè¿™ä½¿ç”¨å…¶ä»–ä¸¤ç§å¾ªç¯ä¹Ÿå¯ä»¥åšåˆ°ï¼š

```rust
fn main() {
    let a = [10, 20, 30, 40, 50];
    let mut index = 0;

    while index < 5 {
        println!("the value is: {}", a[index]);

        index += 1;
    }
}

// 10
// 20
// 30
// 40
// 50
```

ä½†ä½¿ç”¨`for`å¾ªç¯å¯ä»¥å°†ä¸Šé¢çš„è¯­å¥ç®€åŒ–ä¸ºä¸‹é¢çš„ï¼š

```rust
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a.iter() {
        println!("the value is: {}", element);
    }
}

// 10
// 20
// 30
// 40
// 50
```

è¿™æ ·çš„ä»£ç ä¼šæ›´å®‰å…¨ï¼Œå› ä¸ºä¸éœ€è¦æŒ‡å®šæ•°ç»„ä¸‹æ ‡ä¹‹ç±»ï¼Œä¸å­˜åœ¨è¶Šç•Œçš„é—®é¢˜ã€‚

ä¸‹é¢çš„è¯­å¥å¯ä»¥ç”¨äºç”Ÿæˆä¸€ä¸ªæ•°å­—èŒƒå›´ï¼Œç±»ä¼¼ Python ä¸­çš„å†™æ³•ï¼š

```rust
fn main() {
	for number in 1..4 {
        println!("{}!", number);
    }
    println!("LIFTOFF!!!");
}

// 1!
// 2!
// 3!
// LIFTOFF!!!
```

`1..4`å¾ˆæ˜æ˜¾ï¼Œæ˜¯ç”¨æ¥ç”ŸæˆèŒƒå›´$[1,4)$çš„ä¸‰ä¸ªæ•°å­—ï¼Œæ¥ç€ä½¿ç”¨`for`å¾ªç¯éå†è¿™ä¸‰ä¸ªæ•°å­—å¹¶è¾“å‡ºã€‚

æˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹çš„ä»£ç æ¥æŒ‡å®šä¸‹æ ‡ä»æ•°ç»„ä¸­å–å€¼ï¼š

```rust
fn main() {
	let arr = [10, 20, 30, 40, 50];
    for number in 3..5 {
        println!("{}", arr[number]);
    }
}

// 40
// 50
```

##### ç»ƒä¹ 

ç”¨ç›®å‰å­¦ä¹ çš„å†…å®¹å†™ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‡½æ•°ï¼š

```rust
fn fib(mut n: i32) {
    let mut pre = 1;
    let mut post = 1;

    while n > 2 {
        let tmp = post;
        post += pre;
        pre = tmp;
        n-=1;
    }

    println!("{}", post);
}

fn main() {
    fib(1);		// 1
    fib(2);		// 1
    fib(3);		// 2
    fib(10);	// 55
}
```

## æ‰€æœ‰æƒ

æ‰€æœ‰æƒï¼ˆOwnershipï¼‰æ˜¯ Rust æœ€ç‹¬ç‰¹çš„ç‰¹æ€§ï¼Œå®ƒä½¿ Rust èƒ½å¤Ÿåœ¨ä¸éœ€è¦åƒåœ¾æ”¶é›†å™¨çš„æƒ…å†µä¸‹ä¿è¯å†…å­˜å®‰å…¨ã€‚å› æ­¤ï¼Œäº†è§£æ‰€æœ‰æƒåœ¨ Rust ä¸­çš„ä½œç”¨éå¸¸é‡è¦ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæ‰€æœ‰æƒä»¥åŠå‡ ä¸ªç›¸å…³ç‰¹æ€§ï¼šå€Ÿç”¨ï¼ˆborrowingï¼‰ã€åˆ‡ç‰‡ï¼ˆslicesï¼‰ä»¥åŠ Rust å¦‚ä½•åœ¨å†…å­˜ä¸­å¸ƒå±€æ•°æ®ã€‚
